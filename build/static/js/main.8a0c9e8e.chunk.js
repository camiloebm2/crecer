(this.webpackJsonpcrecer=this.webpackJsonpcrecer||[]).push([[0],{18:function(e,a,t){e.exports=t(38)},29:function(e,a,t){},30:function(e,a,t){},31:function(e,a,t){},32:function(e,a,t){},33:function(e,a,t){},34:function(e,a,t){},35:function(e,a,t){},36:function(e,a,t){},37:function(e,a,t){},38:function(e,a,t){"use strict";t.r(a);var r=t(0),o=t.n(r),c=t(14),n=t.n(c),l=t(13),i=t(2),s=t(4);const d=Object(r.createContext)(),u=e=>{let{children:a}=e;const[t,c]=Object(r.useState)([]),[n,l]=Object(r.useState)([]),[i,u]=Object(r.useState)([]),[m,b]=Object(r.useState)([]),[p,E]=Object(r.useState)({fecha_compra:(new Date).toISOString().split("T")[0],forma_pago:"",id_prov:"",num_factura:""});return o.a.createElement(d.Provider,{value:{proveedores:t,presentaciones:n,productos:i,productosSeleccionados:m,detallesCompra:p,actualizarDetallesCompra:(e,a)=>{E(t=>Object(s.a)(Object(s.a)({},t),{},{[e]:a}))},agregarProductoSeleccionado:e=>{b(a=>[...a,e])},eliminarProductoSeleccionado:e=>{b(a=>a.filter(a=>a.id!==e))},cargarDatosIniciales:async e=>{try{const[a,t,r]=await e();c(a),l(t),u(r)}catch(a){console.error("Error cargando datos iniciales:",a)}}}},a)};var m=t(5),b=t(17);const p=Object(b.a)({apiKey:"AIzaSyA--A1JJJsuj2FYCC5y-v8KjEPvUgKg1uI",authDomain:"crecer-2025.firebaseapp.com",databaseURL:"https://crecer-2025-default-rtdb.firebaseio.com",projectId:"crecer-2025",storageBucket:"crecer-2025.firebasestorage.app",messagingSenderId:"759739358419",appId:"1:759739358419:web:2d05b25d0b3022bd1f8826",measurementId:"G-H92M1BM0H1"});var E=Object(m.e)(p),v=t(11);t(29);var h=()=>{const[e,a]=Object(r.useState)(["canastillas","cliente","compras","contable","presentacion","productos","proveedores","punto_venta","trabajadores","usuario"]),[t,c]=Object(r.useState)([]),[n,l]=Object(r.useState)([]),[i,d]=Object(r.useState)(""),[u,b]=Object(r.useState)("");Object(r.useEffect)(()=>{(async()=>{if(i)try{const e=Object(m.a)(E,i),a=await Object(m.d)(e),t=[];a.forEach(e=>{t.push(Object(s.a)({id:e.id},e.data()))}),c(t),t.length>0?l(Object.keys(t[0])):l(["id","campo1","campo2"])}catch(e){console.error("Error cargando datos de la colecci\xf3n:",e)}})()},[i]);return o.a.createElement("div",{className:"gestor-container"},o.a.createElement("div",{className:"header"},o.a.createElement("h1",null,"Gestor de Colecciones"),o.a.createElement("div",{className:"acciones-header"},o.a.createElement("button",{className:"boton-descargar",onClick:()=>{if(0===t.length)return void alert("No hay datos para exportar.");const e=v.b.json_to_sheet(t),a=v.b.book_new();v.b.book_append_sheet(a,e,i),v.c(a,"".concat(i,"_export.xlsx")),alert("Archivo de ".concat(i," exportado con \xe9xito."))}},"Descargar Excel"),o.a.createElement("label",{className:"boton-importar"},"Importar Excel",o.a.createElement("input",{type:"file",accept:".xlsx, .xls",onChange:async e=>{const a=e.target.files[0];if(!a)return void alert("Por favor selecciona un archivo Excel.");const t=new FileReader;t.onload=async e=>{const a=new Uint8Array(e.target.result),t=v.a(a,{type:"array"}),r=t.SheetNames[0],o=v.b.sheet_to_json(t.Sheets[r]);if(i)try{const e=Object(m.a)(E,i),a=o.map(async a=>{const t=a.id||Object(m.b)(e).id,r=Object(m.b)(E,i,t);await Object(m.g)(r,a)});await Promise.all(a),alert("Datos importados con \xe9xito."),c(o)}catch(n){console.error("Error importando datos:",n),alert("Hubo un error al importar los datos.")}else alert("Por favor selecciona una colecci\xf3n antes de importar.")},t.readAsArrayBuffer(a)}})))),o.a.createElement("div",{className:"selector"},o.a.createElement("label",null,"Seleccionar Colecci\xf3n:"),o.a.createElement("select",{value:i,onChange:e=>d(e.target.value)},o.a.createElement("option",{value:""},"-- Seleccionar --"),e.map(e=>o.a.createElement("option",{key:e,value:e},e)))),o.a.createElement("div",{className:"crear-coleccion"},o.a.createElement("label",null,"Nueva Colecci\xf3n:"),o.a.createElement("input",{type:"text",value:u,onChange:e=>b(e.target.value),placeholder:"Nombre de la colecci\xf3n"}),o.a.createElement("button",{onClick:async()=>{if(u)try{const e=Object(m.b)(Object(m.a)(E,u));await Object(m.g)(e,{ejemplo:"Datos iniciales"}),alert("Colecci\xf3n '".concat(u,"' creada con \xe9xito.")),a(e=>[...e,u]),b("")}catch(e){console.error("Error creando nueva colecci\xf3n:",e),alert("Hubo un error al crear la colecci\xf3n.")}else alert("Por favor, ingresa un nombre para la nueva colecci\xf3n.")}},"Crear Colecci\xf3n")),i&&o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",null,"Estructura de la Colecci\xf3n: ",i),o.a.createElement("ul",null,n.map((e,a)=>o.a.createElement("li",{key:a},e))),o.a.createElement("h2",null,"Datos de la Colecci\xf3n"),o.a.createElement("table",{className:"tabla-datos"},o.a.createElement("thead",null,o.a.createElement("tr",null,n.map((e,a)=>o.a.createElement("th",{key:a},e)))),o.a.createElement("tbody",null,t.map((e,a)=>o.a.createElement("tr",{key:a},n.map((a,t)=>o.a.createElement("td",{key:t},e[a]))))))))};var j=e=>{let{value:a,onFechaChange:t}=e;const[c,n]=Object(r.useState)("");Object(r.useEffect)(()=>{const e=a||(()=>{const e=new Date;e.setHours(0,0,0,0);const a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(a,"-").concat(t,"-").concat(r)})();n(e)},[a]);return o.a.createElement("div",{className:"fecha-selector"},o.a.createElement("label",{htmlFor:"fecha"},"Fecha de Compra:"),o.a.createElement("input",{type:"date",id:"fecha",value:c,onChange:e=>{const a=e.target.value;n(a),t(a)}}))};var O=e=>{let{onProveedorSelect:a}=e;const[t,c]=Object(r.useState)(""),[n,l]=Object(r.useState)([]),[i,s]=Object(r.useState)(!1);Object(r.useEffect)(()=>{l([{id:"001",nombre_prov:"Proveedor A"},{id:"002",nombre_prov:"Proveedor B"},{id:"003",nombre_prov:"Proveedor C"}])},[]),Object(r.useEffect)(()=>{console.log("Proveedor seleccionado en BuscarProveedor:",t)},[t]);return o.a.createElement("div",{className:"buscar-proveedor"},o.a.createElement("label",null,"Buscar Proveedor:"),o.a.createElement("input",{type:"text",placeholder:"Ingrese nombre o ID del proveedor",value:t,onChange:e=>{c(e.target.value.toUpperCase()),s(!0)},onFocus:()=>s(!0)}),i&&t&&o.a.createElement("ul",{className:"proveedor-suggestions"},n.filter(e=>e.nombre_prov.toLowerCase().includes(t.toLowerCase())||e.id.includes(t)).map(e=>o.a.createElement("li",{key:e.id,onClick:()=>{return t=e,console.log("Proveedor seleccionado antes de enviar a Compras:",t),a({nombre:t.nombre_prov,id:t.id}),c(t.nombre_prov),void s(!1);var t}},e.id," - ",e.nombre_prov))))};t(30);const g=["ATADO","BANDEJA","BOLSA","BULTO","CAJA","CANASTILLA","DOCENA","HUACAL","KILO","MALLA","PAQUETE","UNIDAD"];var f=e=>{let{onPresentacionSelect:a}=e;const[t,c]=Object(r.useState)(""),[n,l]=Object(r.useState)(!1),i=g.filter(e=>e.includes(t));return o.a.createElement("div",{className:"desplegable-busqueda-container"},o.a.createElement("label",null,"Buscar Presentaci\xf3n:"),o.a.createElement("input",{type:"text",placeholder:"Ingrese tipo de presentaci\xf3n",value:t,onChange:e=>{c(e.target.value.toUpperCase()),l(!0)},onFocus:()=>l(!0),className:"desplegable-busqueda-input"}),n&&t&&o.a.createElement("ul",{className:"desplegable-busqueda-lista"},i.map(e=>o.a.createElement("li",{key:e,onClick:()=>{return a(t=e),c(t),void l(!1);var t},className:"desplegable-busqueda-item"},e))))};t(31);var C=e=>{let{onProductoSelect:a}=e;const[t,c]=Object(r.useState)([]),[n,l]=Object(r.useState)(!1),[i,d]=Object(r.useState)(""),u=Object(r.useRef)(null);Object(r.useEffect)(()=>{(async()=>{const e=Object(m.e)(),a=Object(m.a)(e,"productos");try{const e=(await Object(m.d)(a)).docs.map(e=>Object(s.a)({id:e.id},e.data()));c(e)}catch(t){console.error("Error al cargar productos desde Firebase:",t)}})()},[]);Object(r.useEffect)(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const b=t.filter(e=>e.nombre_prod.toLowerCase().includes(i.toLowerCase()));return o.a.createElement("div",{className:"producto-container",ref:u},o.a.createElement("label",null,"Producto:",o.a.createElement("input",{type:"text",value:i,onChange:e=>{d(e.target.value),l(!0)},placeholder:"Buscar producto",onFocus:()=>l(!0)})),n&&b.length>0&&o.a.createElement("ul",{className:"desplegable"},b.map(e=>o.a.createElement("li",{key:e.id,onMouseDown:()=>{return a(t=e),d(t.nombre_prod),void l(!1);var t}},e.nombre_prod))),n&&0===b.length&&o.a.createElement("p",null,"No se encontraron productos."))};var y=e=>{let{label:a,value:t,onChange:r,placeholder:c}=e;return o.a.createElement("div",{className:"input-numerico"},a&&o.a.createElement("label",null,a),o.a.createElement("input",{type:"text",value:(e=>{if(""===e||null===e||void 0===e)return"";const a=e.toString().replace(/,/g,""),[t,r]=a.split("."),o=t.replace(/\B(?=(\d{3})+(?!\d))/g,",");return void 0!==r?"".concat(o,".").concat(r):o})(t),onChange:e=>{let t=e.target.value.replace(/,/g,"");const o="Utilidad (%)"===a;if(/^-?\d*\.?\d{0,2}$/.test(t)||""===t){if(t.startsWith("0")&&t.length>1&&"."!==t[1]&&(t=t.replace(/^0+/,"")),t.startsWith("-")&&!o)return;r(t)}},placeholder:c||"Ingrese un valor"}))};var S=e=>{let{totalQuantity:a,zarzamora:t,tabora:c,onChange:n}=e;const[l,i]=Object(r.useState)({zarzamora:t.toString(),tabora:c.toString()});Object(r.useEffect)(()=>{i({zarzamora:t.toString(),tabora:c.toString()})},[a,t,c]);const d=e=>{const a=parseFloat(e.replace(/,/g,""))||0;return Math.max(0,a)},u=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e);return o.a.createElement("div",{className:"dynamic-quantity-input"},o.a.createElement("div",null,o.a.createElement(y,{label:"Cantidad Zarzamora",value:l.zarzamora,onChange:e=>{const t=d(e);if(t>a)return i(e=>Object(s.a)(Object(s.a)({},e),{},{zarzamora:u(a),tabora:"0.00"})),void n({zarzamora:a,tabora:0});const r=Math.max(0,parseFloat((a-t).toFixed(2)));i(a=>Object(s.a)(Object(s.a)({},a),{},{zarzamora:e,tabora:u(r)})),n({zarzamora:t,tabora:r})},onBlur:()=>i(e=>Object(s.a)(Object(s.a)({},e),{},{zarzamora:u(d(e.zarzamora))})),placeholder:"Ingrese cantidad para Zarzamora"})),o.a.createElement("div",null,o.a.createElement(y,{label:"Cantidad Tabora",value:l.tabora,onChange:e=>{const t=d(e);if(t>a)return i(e=>Object(s.a)(Object(s.a)({},e),{},{tabora:u(a),zarzamora:"0.00"})),void n({zarzamora:0,tabora:a});const r=Math.max(0,parseFloat((a-t).toFixed(2)));i(a=>Object(s.a)(Object(s.a)({},a),{},{tabora:e,zarzamora:u(r)})),n({zarzamora:r,tabora:t})},onBlur:()=>i(e=>Object(s.a)(Object(s.a)({},e),{},{tabora:u(d(e.tabora))})),placeholder:"Ingrese cantidad para Tabora"})))};t(32);var z=e=>{let{productosLista:a,setProductosLista:t,setCompra:r,setIndiceEdicion:c}=e;return o.a.createElement("div",{className:"productos-registrados"},o.a.createElement("h2",null,"Productos Registrados"),a.length>0?o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Producto"),o.a.createElement("th",null,"Presentaci\xf3n"),o.a.createElement("th",null,"Cantidad"),o.a.createElement("th",null,"Zarzamora"),o.a.createElement("th",null,"Tabora"),o.a.createElement("th",null,"Total"),o.a.createElement("th",null,"Acciones"))),o.a.createElement("tbody",null,a.map((e,n)=>o.a.createElement("tr",{key:n},o.a.createElement("td",null,"string"===typeof e.producto?e.producto:e.producto.nombre_prod),o.a.createElement("td",null,e.presentacion),o.a.createElement("td",null,e.cantidadTotal),o.a.createElement("td",null,e.zarzamora),o.a.createElement("td",null,e.tabora),o.a.createElement("td",null,"$",(e.cantidadTotal*e.precioCompra).toFixed(2)),o.a.createElement("td",null,o.a.createElement("button",{onClick:()=>(e=>{const t=a[e];r({producto:t.producto,presentacion:t.presentacion,cantidadTotal:t.cantidadTotal,zarzamora:t.zarzamora,tabora:t.tabora,precioCompra:t.precioCompra}),c(e)})(n)},"Editar"),o.a.createElement("button",{onClick:()=>(e=>{const r=a.filter((a,t)=>t!==e);t(r)})(n)},"Eliminar")))))):o.a.createElement("p",null,"No hay productos registrados."))};t(33);var N=e=>{let{productosLista:a,setProductosLista:t,setCompra:r}=e;return o.a.createElement("button",{className:"btn-subir-factura",onClick:async()=>{if(0!==a.length)try{const e=(new Date).toISOString().split("T")[0];console.log("Fecha de compra a actualizar:",e);for(const t of a){console.log("Procesando producto:",t);const a=String(t.id_prod||"").trim(),r=Number(t.id_prod)||null;if(!a){console.warn("\u26d4 Producto ignorado por falta de id_prod:",t);continue}const o=Object(m.a)(E,"productos");let c=Object(m.f)(o,Object(m.i)("id_prod","==",a)),n=await Object(m.d)(c);if(n.empty&&null!==r&&(c=Object(m.f)(o,Object(m.i)("id_prod","==",r)),n=await Object(m.d)(c)),n.empty){console.error("\u26d4 No se encontr\xf3 el producto con id_prod: ".concat(t.id_prod));continue}const l=n.docs[0].id,i=Object(m.b)(E,"productos",l),s={fecha_compra:e,cant_tab:Number(t.tabora)||0,cant_zarza:Number(t.zarzamora)||0,precio_compra:Number(t.precioCompra)||0,presentacion:t.presentacion||"No especificada"};console.log("\u2705 Actualizando producto ".concat(l," con datos:"),s),await Object(m.h)(i,s),console.log("\u2705 Producto ".concat(l," actualizado correctamente en Firestore."))}t([]),r({fecha:(new Date).toISOString().split("T")[0],proveedor:"",proveedorId:"",numFactura:"",tipoPago:"debito",producto:"",presentacion:"",cantidadTotal:0,zarzamora:0,tabora:0,precioCompra:0,id_prod:""}),alert("Factura subida y base de datos actualizada con \xe9xito.")}catch(e){console.error("\u274c Error al subir la factura:",e),alert("Hubo un error al subir la factura: ".concat(e.message))}else alert("No hay productos en la factura para subir.")}},"Subir Factura")};t(34);var P=()=>{const e={fecha:(new Date).toISOString().split("T")[0],proveedor:"",proveedorId:"",numFactura:"",tipoPago:"debito",producto:"",presentacion:"Unidad",cantidadTotal:0,zarzamora:0,tabora:0,precioCompra:0,id_prod:""},[a,t]=Object(r.useState)(e),[c,n]=Object(r.useState)([]),[l,i]=Object(r.useState)(0),[d,u]=Object(r.useState)(null);Object(r.useEffect)(()=>{i(c.reduce((e,a)=>e+a.cantidadTotal*a.precioCompra,0))},[c]);return o.a.createElement("div",{className:"compras-container"},o.a.createElement("h1",null,"Registro de Compras"),o.a.createElement(j,{onFechaChange:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{fecha:e})),disabled:c.length>0}),o.a.createElement(O,{onProveedorSelect:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{proveedor:e.nombre,proveedorId:e.id})),disabled:c.length>0}),o.a.createElement(y,{label:"N\xfamero de Factura",value:a.numFactura,onChange:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{numFactura:e})),placeholder:"Ingrese n\xfamero de factura",disabled:c.length>0}),o.a.createElement("div",{className:"tipo-pago-container"},o.a.createElement("label",null,"Tipo de Pago:"),o.a.createElement("select",{value:a.tipoPago,onChange:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{tipoPago:e.target.value}))},o.a.createElement("option",{value:"debito"},"D\xe9bito"),o.a.createElement("option",{value:"credito"},"Cr\xe9dito"))),o.a.createElement(f,{onPresentacionSelect:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{presentacion:e}))}),o.a.createElement(C,{onProductoSelect:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{producto:e.nombre_prod,id_prod:e.id_prod}))}),o.a.createElement(y,{label:"Cantidad Total",value:a.cantidadTotal,onChange:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{cantidadTotal:Number(e)}))}),o.a.createElement(S,{totalQuantity:a.cantidadTotal,zarzamora:a.zarzamora,tabora:a.tabora,onChange:e=>{let{zarzamora:a,tabora:r}=e;return t(e=>Object(s.a)(Object(s.a)({},e),{},{zarzamora:a,tabora:r}))}}),o.a.createElement(y,{label:"Precio de Compra",value:a.precioCompra,onChange:e=>t(a=>Object(s.a)(Object(s.a)({},a),{},{precioCompra:Number(e)}))}),o.a.createElement("button",{className:"btn-agregar",onClick:()=>{if(!a.producto||!a.presentacion||a.cantidadTotal<=0)return void alert("Debe completar los datos del producto antes de agregarlo.");const r=Object(s.a)(Object(s.a)({},a),{},{cantidadTotal:Number(a.cantidadTotal),zarzamora:Number(a.zarzamora),tabora:Number(a.tabora),precioCompra:Number(a.precioCompra),id_prod:a.id_prod||""});r.id_prod?(n(e=>null!==d?e.map((e,a)=>a===d?r:e):[...e,r]),u(null),t(e)):alert("El producto seleccionado no tiene un ID v\xe1lido.")}},null!==d?"Actualizar Producto":"Agregar Producto"),o.a.createElement(z,{productosLista:c,setProductosLista:n,setCompra:t,setIndiceEdicion:u}),o.a.createElement("h3",null,"Total Factura: $",l.toFixed(2)),o.a.createElement("div",{className:"subir-factura-container"},o.a.createElement(N,{productosLista:c,setProductosLista:n,setCompra:t,onSubmit:async()=>{try{const r=c.map(async e=>{if(!e.id_prod)return void console.error("Producto sin ID v\xe1lido:",e);const t=Object(m.b)(E,"productos",e.id_prod);console.log("Actualizando producto ".concat(e.id_prod," con presentaci\xf3n: ").concat(e.presentacion)),await Object(m.h)(t,{presentacion:e.presentacion,fecha_compra:a.fecha})});await Promise.all(r),alert("Factura subida y presentaci\xf3n actualizada en Firebase."),n([]),t(e)}catch(r){console.error("Error al subir la factura:",r)}}})))};var _=e=>{let{filtro:a,setFiltro:t}=e;return o.a.createElement("div",{className:"filtro-container"},o.a.createElement("label",null,"Filtrar:"),o.a.createElement("select",{value:a,onChange:e=>t(e.target.value)},o.a.createElement("option",{value:"todos"},"Todos los productos"),o.a.createElement("option",{value:"con_compra"},"Productos con compra (hoy)")))};const F=["malla","2000","3000","bandeja","entero","bulto","medio_bulto","canastilla","bolsa","docena","oferta"];var w=e=>{let{cerrarModal:a,productoId:t}=e;const[c,n]=Object(r.useState)([]),l=Object(r.useCallback)(async()=>{if(t){const e=Object(m.b)(E,"productos",t),a=await Object(m.c)(e);if(a.exists()){const e=a.data(),t=F.filter(a=>"inactivo"===e[a]);n(t)}}},[t]);Object(r.useEffect)(()=>{l()},[l]);return o.a.createElement("div",{className:"tabla-presentaciones-inactivas"},o.a.createElement("h3",null,"Presentaciones Inactivas"),o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Tipo"),o.a.createElement("th",null,"Acci\xf3n"))),o.a.createElement("tbody",null,c.map(e=>o.a.createElement("tr",{key:e},o.a.createElement("td",null,e),o.a.createElement("td",null,o.a.createElement("button",{className:"btn-activar",onClick:()=>(async e=>{try{const a=Object(m.b)(E,"productos",t);await Object(m.h)(a,{[e]:"activo"}),n(a=>a.filter(a=>a!==e))}catch(a){console.error("Error al activar presentaci\xf3n:",a)}})(e)},"Activar")))))),o.a.createElement("button",{className:"btn-cerrar",onClick:a},"Cerrar"))};t(35);const k=["malla","2000","3000","bandeja","entero","bulto","medio_bulto","canastilla","bolsa","docena","oferta"];var x=e=>{let{producto:a}=e;const[t,c]=Object(r.useState)([]),[n,l]=Object(r.useState)(!1),i=Object(r.useCallback)(async()=>{if(a){const e=Object(m.b)(E,"productos",a.id),t=await Object(m.c)(e);if(t.exists()){const e=t.data(),a=k.filter(a=>"activo"===e[a]);c(a)}}},[a]);Object(r.useEffect)(()=>{i()},[i]);return o.a.createElement("div",{className:"tabla-presentaciones"},o.a.createElement("h3",null,"Precios por Presentaci\xf3n de ",a.nombre_prod),o.a.createElement("button",{className:"btn-activar",onClick:()=>l(!0)},"Activar Presentaciones"),n&&o.a.createElement(w,{cerrarModal:()=>{l(!1),i()},productoId:a.id}),o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Tipo"),o.a.createElement("th",null,"Precio"),o.a.createElement("th",null,"Acci\xf3n"))),o.a.createElement("tbody",null,t.map(e=>o.a.createElement("tr",{key:e},o.a.createElement("td",null,e),o.a.createElement("td",null,o.a.createElement("input",{type:"number",placeholder:"Ingrese precio para ".concat(e)})),o.a.createElement("td",null,o.a.createElement("button",{className:"btn-desactivar",onClick:()=>(async e=>{try{const t=Object(m.b)(E,"productos",a.id);await Object(m.h)(t,{[e]:"inactivo"}),c(a=>a.filter(a=>a!==e))}catch(t){console.error("Error al desactivar presentaci\xf3n:",t)}})(e)},"Desactivar")))))))};var I=e=>{let{productos:a,cambios:t,manejarCambio:c,fechaHoy:n}=e;const[l,i]=Object(r.useState)(null),[s,d]=Object(r.useState)(!1);return o.a.createElement("div",{className:"tabla-container"},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Producto"),o.a.createElement("th",null,"\xdaltimo Precio"),o.a.createElement("th",null,"Total Compra"),o.a.createElement("th",null,"Nuevo Precio"),o.a.createElement("th",null,"Precio Unitario"),o.a.createElement("th",null,"Utilidad (%)"),o.a.createElement("th",null,"Tara"),o.a.createElement("th",null,"Presentaci\xf3n"),o.a.createElement("th",null,"Zarzamora Unidades"),o.a.createElement("th",null,"Tabora Unidades"))),o.a.createElement("tbody",null,a.filter(e=>!l||e.id===l.id).map(e=>{var a,r,n,s,u,m,b,p;const E=e.precio_compra||1,v=null!==(a=null!==(r=null===(n=t[e.id])||void 0===n?void 0:n.nuevoPrecio)&&void 0!==r?r:e.precioc_ult)&&void 0!==a?a:0,h=v>0&&E>0?((v-E)/E*100).toFixed(2):"";return o.a.createElement(o.a.Fragment,{key:e.id},o.a.createElement("tr",null,o.a.createElement("td",{className:"producto-clickable",onClick:()=>(e=>{i(a=>(null===a||void 0===a?void 0:a.id)===e.id?null:e)})(e)},e.nombre_prod||"Sin nombre"),o.a.createElement("td",null,e.precioc_ult||0),o.a.createElement("td",null,e.precio_compra||0),o.a.createElement("td",null,o.a.createElement(y,{value:v,onChange:a=>{if(c(e.id,"nuevoPrecio",a),E>0){const t=(a-E)/E*100;c(e.id,"utilidad",t.toFixed(2))}}})),o.a.createElement("td",null,E.toFixed(2)),o.a.createElement("td",null,o.a.createElement(y,{value:null!==(s=null===(u=t[e.id])||void 0===u?void 0:u.utilidad)&&void 0!==s?s:h,onChange:a=>{if(c(e.id,"utilidad",a),E>0){const t=E*(1+a/100);c(e.id,"nuevoPrecio",t.toFixed(2))}}})),o.a.createElement("td",null,o.a.createElement(y,{value:null!==(m=null!==(b=null===(p=t[e.id])||void 0===p?void 0:p.tara)&&void 0!==b?b:e.tara)&&void 0!==m?m:1,onChange:a=>c(e.id,"tara",a)})),o.a.createElement("td",null,e.presentacion||"No disponible"),o.a.createElement("td",null,e.cant_zarza||0),o.a.createElement("td",null,e.cant_tab||0)),(null===l||void 0===l?void 0:l.id)===e.id&&o.a.createElement("tr",null,o.a.createElement("td",{colSpan:"10"},o.a.createElement(x,{producto:e,mostrarActivarPresentaciones:()=>d(!0)}))))}))),s&&l&&o.a.createElement(f,{producto:l,cerrarModal:()=>d(!1)}))};t(36);var A=()=>{const[e,a]=Object(r.useState)([]),[t,c]=Object(r.useState)("todos"),[n,l]=Object(r.useState)({}),i=(new Date).toISOString().split("T")[0];Object(r.useEffect)(()=>{(async()=>{try{const e=(await Object(m.d)(Object(m.a)(E,"productos"))).docs.map(e=>Object(s.a)({id:e.id},e.data()));a(e)}catch(e){console.error("Error al cargar productos:",e)}})()},[]);const d=e.filter(e=>"con_compra"!==t||e.fecha_compra===i);return o.a.createElement("div",{className:"cambio-precios-container"},o.a.createElement("h1",null,"Cambio de Precios"),o.a.createElement(_,{filtro:t,setFiltro:c}),o.a.createElement(I,{productos:d,cambios:n,manejarCambio:(e,a,t)=>{l(r=>Object(s.a)(Object(s.a)({},r),{},{[e]:Object(s.a)(Object(s.a)({},r[e]),{},{[a]:t})}))},fechaHoy:i}),o.a.createElement("button",{className:"btn-guardar",onClick:async()=>{try{const e=Object.keys(n).map(async e=>{const a=Object(m.b)(E,"productos",e);await Object(m.h)(a,n[e])});await Promise.all(e),alert("Cambios guardados exitosamente."),l({})}catch(e){console.error("Error al actualizar datos:",e)}},disabled:0===Object.keys(n).length},"Guardar Cambios"))};t(37);var T=()=>o.a.createElement(u,null,o.a.createElement(l.a,null,o.a.createElement("div",{className:"app"},o.a.createElement("header",{className:"header"},o.a.createElement(l.b,{to:"/"},"Gestor Base de Datos"),o.a.createElement(l.b,{to:"/compras"},"Compras"),o.a.createElement(l.b,{to:"/cambio-precios"},"Cambio de Precios")),o.a.createElement("div",{className:"content"},o.a.createElement(i.c,null,o.a.createElement(i.a,{path:"/",element:o.a.createElement(h,null)}),o.a.createElement(i.a,{path:"/compras",element:o.a.createElement(P,null)}),o.a.createElement(i.a,{path:"/cambio-precios",element:o.a.createElement(A,null)}))))));n.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(T,null)),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.8a0c9e8e.chunk.js.map